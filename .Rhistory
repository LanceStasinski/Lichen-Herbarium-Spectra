stats_list = list.append(stats_list, ranIntercepts) #1
stats_list = list.append(stats_list, intercept_variance) #2
stats_list = list.append(stats_list, resid_variance) #3
stats_list = list.append(stats_list, psuedoR2) #4
stats_list = list.append(stats_list, fixed_intercept_list) #5
stats_list = list.append(stats_list, fixed_age_list) #6
stats_list = list.append(stats_list, fixed_normMag_list) #7
stats_list = list.append(stats_list, intercept_2.5_list) #8
stats_list = list.append(stats_list, intercept_97.5_list) #9
stats_list = list.append(stats_list, age_2.5_list) #10
stats_list = list.append(stats_list, age_97.5_list) #11
stats_list = list.append(stats_list, normMag_2.5_list) #12
stats_list = list.append(stats_list, normMag_97.5_list) #13
saveRDS(stats_list, 'models/lmms/lmm_60yrs_fixedSlope_vn.rds')
par(mfrow = c(1,1))
#slopes - age
wv = seq(400, 2400, 1)
plot(wv, stats_list[[6]],
type = 'l',
xlab = 'Wavelength (nm)',
ylab = 'Effect of age (% reflectance/year)',
ylim = c(min(stats_list[[10]]), max(stats_list[[11]])),
main = 'Effect of age')
polygon(c(wv, rev(wv)), c(stats_list[[10]], rev(stats_list[[11]])),
col = 'grey90',
lty = 0)
abline(h = 0, lty = 2, col = 'blue')
lines(wv, stats_list[[6]])
wv = seq(400, 2400, 1)
plot(wv, stats_list[[6]],
type = 'l',
xlab = 'Wavelength (nm)',
ylab = 'Effect of age (Vector normalized reflectance/year)',
ylim = c(min(stats_list[[10]]), max(stats_list[[11]])),
main = 'Effect of age')
polygon(c(wv, rev(wv)), c(stats_list[[10]], rev(stats_list[[11]])),
col = 'grey90',
lty = 0)
abline(h = 0, lty = 2, col = 'blue')
lines(wv, stats_list[[6]])
wv = seq(400, 2400, 1)
plot(wv, stats_list[[7]],
type = 'l',
xlab = 'Wavelength (nm)',
ylab = 'Effect of normalization magnitude (reflectance/unit magnitude)',
ylim = c(min(stats_list[[12]]), max(stats_list[[13]])),
main = 'Effect of normalization magnitude')
polygon(c(wv, rev(wv)), c(stats_list[[12]], rev(stats_list[[13]])),
col = 'grey90',
lty = 0)
abline(h = 0, lty = 2, col = 'blue')
lines(wv, stats_list[[7]])
#intercepts
wv = seq(400, 2400, 1)
plot(wv, stats_list[[5]],
type = 'l',
xlab = 'Wavelength (nm)',
ylab = 'Intercept (% reflectance)',
ylim = c(min(stats_list[[1]]), max(stats_list[[1]])),
main = 'Intercepts')
polygon(c(wv, rev(wv)), c(stats_list[[8]], rev(stats_list[[9]])),
col = 'grey90',
lty = 0)
for (i in 1:nrow(stats_list[[1]])){
lines(wv, stats_list[[1]][i,], col = 'grey' )
}
abline(h = 0, lty = 2, col = 'blue')
lines(wv, stats_list[[5]])
wv = seq(400, 2400, 1)
plot(wv, stats_list[[2]],
ylim = c(min(stats_list[[2]]), max(stats_list[[2]])),
main = 'Random effects variance',
ylab = 'Variance',
xlab = 'Wavelength (nm)',
col = 'blue',
type = 'l')
lines(wv, stats_list[[3]], col = 'gray')
legend('topright',
c('Intercept', 'Residual'),
col = c('blue', 'gray'), lty = c(1,1,1))
wv = seq(400, 2400, 1)
plot(wv, stats_list[[4]],
ylim = c(0, 100),
main = 'Random effects variance explained by species',
ylab = 'Percent variance explained',
xlab = 'Wavelength (nm)',
type = 'l')
wv = seq(400, 2400, 1)
plot(wv, stats_list[[4]],
ylim = range(stats_list[[4]]),
main = 'Random effects variance explained by species',
ylab = 'Percent variance explained',
xlab = 'Wavelength (nm)',
type = 'l')
par(mfrow = c(2,3))
#slopes - age
wv = seq(400, 2400, 1)
plot(wv, stats_list[[6]],
type = 'l',
xlab = 'Wavelength (nm)',
ylab = 'Effect of age (Vector normalized reflectance/year)',
ylim = c(min(stats_list[[10]]), max(stats_list[[11]])),
main = 'Effect of age')
polygon(c(wv, rev(wv)), c(stats_list[[10]], rev(stats_list[[11]])),
col = 'grey90',
lty = 0)
abline(h = 0, lty = 2, col = 'blue')
lines(wv, stats_list[[6]])
#slopes - normMag
wv = seq(400, 2400, 1)
plot(wv, stats_list[[7]],
type = 'l',
xlab = 'Wavelength (nm)',
ylab = 'Effect of normalization magnitude (reflectance/unit magnitude)',
ylim = c(min(stats_list[[12]]), max(stats_list[[13]])),
main = 'Effect of normalization magnitude')
polygon(c(wv, rev(wv)), c(stats_list[[12]], rev(stats_list[[13]])),
col = 'grey90',
lty = 0)
abline(h = 0, lty = 2, col = 'blue')
lines(wv, stats_list[[7]])
#intercepts
wv = seq(400, 2400, 1)
plot(wv, stats_list[[5]],
type = 'l',
xlab = 'Wavelength (nm)',
ylab = 'Intercept (Vector normalized reflectance)',
ylim = c(min(stats_list[[1]]), max(stats_list[[1]])),
main = 'Intercepts')
polygon(c(wv, rev(wv)), c(stats_list[[8]], rev(stats_list[[9]])),
col = 'grey90',
lty = 0)
for (i in 1:nrow(stats_list[[1]])){
lines(wv, stats_list[[1]][i,], col = 'grey' )
}
abline(h = 0, lty = 2, col = 'blue')
lines(wv, stats_list[[5]])
#variances
wv = seq(400, 2400, 1)
plot(wv, stats_list[[2]],
ylim = c(min(stats_list[[2]]), max(stats_list[[2]])),
main = 'Random effects variance',
ylab = 'Variance',
xlab = 'Wavelength (nm)',
col = 'blue',
type = 'l')
lines(wv, stats_list[[3]], col = 'gray')
legend('topright',
c('Intercept', 'Residual'),
col = c('blue', 'gray'), lty = c(1,1,1))
#Random Variance explained
wv = seq(400, 2400, 1)
plot(wv, stats_list[[4]],
ylim = range(stats_list[[4]]),
main = 'Random effects variance explained by species',
ylab = 'Proportion of variance explained',
xlab = 'Wavelength (nm)',
type = 'l')
par(mfrow = c(2,3))
#slopes - age
wv = seq(400, 2400, 1)
plot(wv, stats_list[[6]],
type = 'l',
xlab = 'Wavelength (nm)',
ylab = 'Vector normalized reflectance / year',
ylim = c(min(stats_list[[10]]), max(stats_list[[11]])),
main = 'Effect of age')
polygon(c(wv, rev(wv)), c(stats_list[[10]], rev(stats_list[[11]])),
col = 'grey90',
lty = 0)
abline(h = 0, lty = 2, col = 'blue')
lines(wv, stats_list[[6]])
#slopes - normMag
wv = seq(400, 2400, 1)
plot(wv, stats_list[[7]],
type = 'l',
xlab = 'Wavelength (nm)',
ylab = 'Reflectance / unit normalization magnitude)',
ylim = c(min(stats_list[[12]]), max(stats_list[[13]])),
main = 'Effect of normalization magnitude')
polygon(c(wv, rev(wv)), c(stats_list[[12]], rev(stats_list[[13]])),
col = 'grey90',
lty = 0)
abline(h = 0, lty = 2, col = 'blue')
lines(wv, stats_list[[7]])
#intercepts
wv = seq(400, 2400, 1)
plot(wv, stats_list[[5]],
type = 'l',
xlab = 'Wavelength (nm)',
ylab = 'Vector normalized reflectance',
ylim = c(min(stats_list[[1]]), max(stats_list[[1]])),
main = 'Intercepts')
polygon(c(wv, rev(wv)), c(stats_list[[8]], rev(stats_list[[9]])),
col = 'grey90',
lty = 0)
for (i in 1:nrow(stats_list[[1]])){
lines(wv, stats_list[[1]][i,], col = 'grey' )
}
abline(h = 0, lty = 2, col = 'blue')
lines(wv, stats_list[[5]])
#variances
wv = seq(400, 2400, 1)
plot(wv, stats_list[[2]],
ylim = c(min(stats_list[[2]]), max(stats_list[[2]])),
main = 'Random effects variance',
ylab = 'Variance',
xlab = 'Wavelength (nm)',
col = 'blue',
type = 'l')
lines(wv, stats_list[[3]], col = 'gray')
legend('topright',
c('Intercept', 'Residual'),
col = c('blue', 'gray'), lty = c(1,1,1))
#Random Variance explained
wv = seq(400, 2400, 1)
plot(wv, stats_list[[4]],
ylim = range(stats_list[[4]]),
main = 'Random effects variance explained by species',
ylab = 'Proportion of variance explained',
xlab = 'Wavelength (nm)',
type = 'l')
tiff(filename = 'figures/paper-figures/fixedSlope_results.tif',
width = 10, height = 8, units = 'in', res = 1200)
par(mfrow = c(2,3))
#slopes - age
wv = seq(400, 2400, 1)
plot(wv, stats_list[[6]],
type = 'l',
xlab = 'Wavelength (nm)',
ylab = 'Vector normalized reflectance / year',
ylim = c(min(stats_list[[10]]), max(stats_list[[11]])),
main = 'Effect of age')
polygon(c(wv, rev(wv)), c(stats_list[[10]], rev(stats_list[[11]])),
col = 'grey90',
lty = 0)
abline(h = 0, lty = 2, col = 'blue')
lines(wv, stats_list[[6]])
#slopes - normMag
wv = seq(400, 2400, 1)
plot(wv, stats_list[[7]],
type = 'l',
xlab = 'Wavelength (nm)',
ylab = 'Reflectance / unit normalization magnitude)',
ylim = c(min(stats_list[[12]]), max(stats_list[[13]])),
main = 'Effect of normalization magnitude')
polygon(c(wv, rev(wv)), c(stats_list[[12]], rev(stats_list[[13]])),
col = 'grey90',
lty = 0)
abline(h = 0, lty = 2, col = 'blue')
lines(wv, stats_list[[7]])
#intercepts
wv = seq(400, 2400, 1)
plot(wv, stats_list[[5]],
type = 'l',
xlab = 'Wavelength (nm)',
ylab = 'Vector normalized reflectance',
ylim = c(min(stats_list[[1]]), max(stats_list[[1]])),
main = 'Intercepts')
polygon(c(wv, rev(wv)), c(stats_list[[8]], rev(stats_list[[9]])),
col = 'grey90',
lty = 0)
for (i in 1:nrow(stats_list[[1]])){
lines(wv, stats_list[[1]][i,], col = 'grey' )
}
abline(h = 0, lty = 2, col = 'blue')
lines(wv, stats_list[[5]])
#variances
wv = seq(400, 2400, 1)
plot(wv, stats_list[[2]],
ylim = c(min(stats_list[[2]]), max(stats_list[[2]])),
main = 'Random effects variance',
ylab = 'Variance',
xlab = 'Wavelength (nm)',
col = 'blue',
type = 'l')
lines(wv, stats_list[[3]], col = 'gray')
legend('topright',
c('Intercept', 'Residual'),
col = c('blue', 'gray'), lty = c(1,1,1))
#Random Variance explained
wv = seq(400, 2400, 1)
plot(wv, stats_list[[4]],
ylim = range(stats_list[[4]]),
main = 'Random effects variance explained by species',
ylab = 'Proportion of variance explained',
xlab = 'Wavelength (nm)',
type = 'l')
dev.off()
stats_list = readRDS('models/lmms/lmm_60yrs_fixedSlope.rds')
tiff(filename = 'figures/paper-figures/fixedSlope_results.tif',
width = 10, height = 8, units = 'in', res = 1200)
par(mfrow = c(2,2))
#slopes
wv = seq(400, 2400, 1)
plot(wv, stats_list[[6]],
type = 'l',
xlab = 'Wavelength (nm)',
ylab = 'Effect of age (% reflectance/year)',
ylim = c(min(stats_list[[9]]), max(stats_list[[10]])),
main = 'Fixed slope')
polygon(c(wv, rev(wv)), c(stats_list[[9]], rev(stats_list[[10]])),
col = 'grey90',
lty = 0)
abline(h = 0, lty = 2, col = 'blue')
lines(wv, stats_list[[6]])
#intercepts
wv = seq(400, 2400, 1)
plot(wv, stats_list[[5]],
type = 'l',
xlab = 'Wavelength (nm)',
ylab = 'Intercept (% reflectance)',
ylim = c(min(stats_list[[1]]), max(stats_list[[1]])),
main = 'Intercepts')
polygon(c(wv, rev(wv)), c(stats_list[[7]], rev(stats_list[[8]])),
col = 'grey90',
lty = 0)
for (i in 1:nrow(stats_list[[1]])){
lines(wv, stats_list[[1]][i,], col = 'grey' )
}
abline(h = 0, lty = 2, col = 'blue')
lines(wv, stats_list[[5]])
#variances
wv = seq(400, 2400, 1)
plot(wv, stats_list[[2]],
ylim = c(min(stats_list[[2]]), max(stats_list[[2]])),
main = 'Random effects variance',
ylab = 'Variance',
xlab = 'Wavelength (nm)',
col = 'blue',
type = 'l')
lines(wv, stats_list[[3]], col = 'gray')
legend('topright',
c('Intercept', 'Residual'),
col = c('blue', 'gray'), lty = c(1,1,1))
#Random Variance explained
wv = seq(400, 2400, 1)
plot(wv, stats_list[[4]],
ylim = range(stats_list[[4]]),
main = 'Random effects variance explained by species',
ylab = 'Proportion of variance explained',
xlab = 'Wavelength (nm)',
type = 'l')
dev.off()
stats_list = readRDS('models/lmms/lmm_60yrs_fixedSlope_vn.rds')
tiff(filename = 'figures/paper-figures/fixedSlope_results_vn.tif',
width = 8, height = 5, units = 'in', res = 1200)
par(mfrow = c(2,3))
#slopes - age
wv = seq(400, 2400, 1)
plot(wv, stats_list[[6]],
type = 'l',
xlab = 'Wavelength (nm)',
ylab = 'Vector normalized reflectance / year',
ylim = c(min(stats_list[[10]]), max(stats_list[[11]])),
main = 'Effect of age')
polygon(c(wv, rev(wv)), c(stats_list[[10]], rev(stats_list[[11]])),
col = 'grey90',
lty = 0)
abline(h = 0, lty = 2, col = 'blue')
lines(wv, stats_list[[6]])
#slopes - normMag
wv = seq(400, 2400, 1)
plot(wv, stats_list[[7]],
type = 'l',
xlab = 'Wavelength (nm)',
ylab = 'Reflectance / unit normalization magnitude)',
ylim = c(min(stats_list[[12]]), max(stats_list[[13]])),
main = 'Effect of normalization magnitude')
polygon(c(wv, rev(wv)), c(stats_list[[12]], rev(stats_list[[13]])),
col = 'grey90',
lty = 0)
abline(h = 0, lty = 2, col = 'blue')
lines(wv, stats_list[[7]])
#intercepts
wv = seq(400, 2400, 1)
plot(wv, stats_list[[5]],
type = 'l',
xlab = 'Wavelength (nm)',
ylab = 'Vector normalized reflectance',
ylim = c(min(stats_list[[1]]), max(stats_list[[1]])),
main = 'Intercepts')
polygon(c(wv, rev(wv)), c(stats_list[[8]], rev(stats_list[[9]])),
col = 'grey90',
lty = 0)
for (i in 1:nrow(stats_list[[1]])){
lines(wv, stats_list[[1]][i,], col = 'grey' )
}
abline(h = 0, lty = 2, col = 'blue')
lines(wv, stats_list[[5]])
#variances
wv = seq(400, 2400, 1)
plot(wv, stats_list[[2]],
ylim = c(min(stats_list[[2]]), max(stats_list[[2]])),
main = 'Random effects variance',
ylab = 'Variance',
xlab = 'Wavelength (nm)',
col = 'blue',
type = 'l')
lines(wv, stats_list[[3]], col = 'gray')
legend('topright',
c('Intercept', 'Residual'),
col = c('blue', 'gray'), lty = c(1,1,1))
#Random Variance explained
wv = seq(400, 2400, 1)
plot(wv, stats_list[[4]],
ylim = range(stats_list[[4]]),
main = 'Random effects variance explained by species',
ylab = 'Proportion of variance explained',
xlab = 'Wavelength (nm)',
type = 'l')
dev.off()
tiff(filename = 'figures/paper-figures/fixedSlope_results_vn.tif',
width = 12, height = 8, units = 'in', res = 1200)
par(mfrow = c(2,3))
#slopes - age
wv = seq(400, 2400, 1)
plot(wv, stats_list[[6]],
type = 'l',
xlab = 'Wavelength (nm)',
ylab = 'Vector normalized reflectance / year',
ylim = c(min(stats_list[[10]]), max(stats_list[[11]])),
main = 'Effect of age')
polygon(c(wv, rev(wv)), c(stats_list[[10]], rev(stats_list[[11]])),
col = 'grey90',
lty = 0)
abline(h = 0, lty = 2, col = 'blue')
lines(wv, stats_list[[6]])
#slopes - normMag
wv = seq(400, 2400, 1)
plot(wv, stats_list[[7]],
type = 'l',
xlab = 'Wavelength (nm)',
ylab = 'Reflectance / unit normalization magnitude)',
ylim = c(min(stats_list[[12]]), max(stats_list[[13]])),
main = 'Effect of normalization magnitude')
polygon(c(wv, rev(wv)), c(stats_list[[12]], rev(stats_list[[13]])),
col = 'grey90',
lty = 0)
abline(h = 0, lty = 2, col = 'blue')
lines(wv, stats_list[[7]])
#intercepts
wv = seq(400, 2400, 1)
plot(wv, stats_list[[5]],
type = 'l',
xlab = 'Wavelength (nm)',
ylab = 'Vector normalized reflectance',
ylim = c(min(stats_list[[1]]), max(stats_list[[1]])),
main = 'Intercepts')
polygon(c(wv, rev(wv)), c(stats_list[[8]], rev(stats_list[[9]])),
col = 'grey90',
lty = 0)
for (i in 1:nrow(stats_list[[1]])){
lines(wv, stats_list[[1]][i,], col = 'grey' )
}
abline(h = 0, lty = 2, col = 'blue')
lines(wv, stats_list[[5]])
#variances
wv = seq(400, 2400, 1)
plot(wv, stats_list[[2]],
ylim = c(min(stats_list[[2]]), max(stats_list[[2]])),
main = 'Random effects variance',
ylab = 'Variance',
xlab = 'Wavelength (nm)',
col = 'blue',
type = 'l')
lines(wv, stats_list[[3]], col = 'gray')
legend('topright',
c('Intercept', 'Residual'),
col = c('blue', 'gray'), lty = c(1,1,1))
#Random Variance explained
wv = seq(400, 2400, 1)
plot(wv, stats_list[[4]],
ylim = range(stats_list[[4]]),
main = 'Random effects variance explained by species',
ylab = 'Proportion of variance explained',
xlab = 'Wavelength (nm)',
type = 'l')
dev.off()
library(spectrolab)
library(lme4)
library(nlme)
library(ggplot2)
library(ggeffects)
library(sjPlot)
library(rlist)
library(optimx)
library(forecast)
#example
spectra = readRDS('spectra/lichen_spectra.rds')
length(unique(meta(spectra)$X))
length(unique(meta(spectra)$scientificName))
min(meta(specta)$age)
min(meta(spectra)$age)
max(meta(spectra)$age)
hist(meta(spectra)$age)
hist(meta(spectra)$age, main = 'Histogram of specimen age', xlab = 'Specimen age')
tiff(filename = '../../lichen figures/age-hist.tif',
width = 8, height = 6, units = 'in', res = 1200)
hist(meta(spectra)$age, main = 'Histogram of specimen age', xlab = 'Specimen age')
dev.off()
?tiff
jpeg(filename = '../../lichen figures/age-hist.jpeg',
width = 8, height = 6, units = 'in', res = 1200)
hist(meta(spectra)$age, main = 'Histogram of specimen age', xlab = 'Specimen age')
dev.off()
jpeg(filename = '../../lichen figures/age-hist.jpeg',
width = 8, height = 6, units = 'in', res = 1200)
hist(meta(spectra)$age, main = 'Histogram of specimen age', xlab = 'Specimen age (years)')
dev.off()
2018 - 60
2018 -110
